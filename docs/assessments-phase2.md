# Assessments Phase 2 (Teacher Base + Timed Student Runtime)

## Что добавлено

1. База тестов преподавателя:
- отдельная страница `/teacher/tests` c back-navigation,
- навигация по статусам `Опубликованы/Черновики`,
- поиск по названию,
- карточки с метаданными (вопросы, время, статус) и действиями.

2. Новый редактор шаблона теста:
- поля `тема`, `описание`, `время прохождения (мин)`,
- список вопросов с drag-and-drop перестановкой,
- отдельный редактор вопроса справа,
- загрузка изображений с мгновенным мини-preview,
- автоматическое определение типа ответа (`text/number/expression`) при сохранении,
- единая кнопка `Сохранить шаблон` + модальное решение `черновик/публикация`,
- auto-draft при выходе из редактора.

3. Интеграция в редактор курса:
- добавление тестов только из опубликованных шаблонов,
- preview теста в read-only режиме,
- reorder очереди уроков/тестов drag-and-drop,
- auto-save черновика курса при закрытии модалки, если введены данные.

4. Student runtime для тестов:
- маршрут `/courses/:courseId/tests/:testItemId`,
- контроль prerequisites: тест открывается только после прохождения предыдущих материалов,
- таймер с обратным отсчетом и цветовой индикацией,
- автосохранение in-progress попытки (ответы + позиция + остаток времени),
- восстановление сессии после выхода с продолжением времени с сохраненного остатка,
- отправка с предупреждением о неотвеченных вопросах,
- автоотправка при окончании времени,
- модальное окно результатов (правильные ответы/пояснения по каждому вопросу),
- история всех попыток с оценкой (`Неудовлетворительно/Удовлетворительно/Хорошо/Отлично`).

5. Прогресс и визуал:
- в `CourseDetails` добавлены метрики: количество занятий/тестов,
- кольцевые индикаторы: прогресс курса + проверка знаний,
- roadmap теперь включает тестовые узлы и особую подсветку тестов,
- в карточках курсов студента и карточках учителя по студенту добавлен показатель `Проверка знаний`.

## Архитектурные ограничения и риски

1. Хранение assessments пока в local storage/mock state:
- это достаточно для текущей front-end фазы,
- для production нужно перенести templates/attempts/sessions в API/DB слой.

2. Session autosave теста:
- реализован устойчивый UX-механизм для падения страницы/выхода пользователя,
- при полном очищении браузерного storage сессия не восстанавливается (ожидаемое поведение текущего этапа).

3. Анти-скриншот/анти-запись:
- только best-effort deterrent, не абсолютная блокировка (ограничение браузеров).

## Следующий логичный шаг

1. Перевести assessments storage с localStorage на `/api/assessments/*` (mock server first).
2. Добавить role-aware серверные проверки доступа к шаблонам/попыткам.
3. Добавить интеграционные тесты для сценариев:
- auto-draft template/course,
- timed attempt restore,
- prerequisites locking,
- best-score knowledge metric consistency.
